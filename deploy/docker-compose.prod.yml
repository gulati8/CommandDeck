services:
  commanddeck:
    image: ghcr.io/gulati8/commanddeck:latest
    container_name: commanddeck
    restart: unless-stopped
    env_file: .env
    volumes:
      - commanddeck-state:/home/commanddeck/.commanddeck
      - commanddeck-projects:/home/commanddeck/projects
      - /var/run/docker.sock:/var/run/docker.sock
      - /srv:/srv:rw
    group_add:
      - "${DOCKER_GID:-993}"
    networks:
      - proxy

  dashboard:
    image: ghcr.io/gulati8/commanddeck-dashboard:latest
    container_name: commanddeck-dashboard
    restart: unless-stopped
    environment:
      - COMMANDDECK_STATE_DIR=/home/commanddeck/.commanddeck
      - DASHBOARD_PORT=3002
      - Q_HOST=commanddeck
      - Q_PORT=3001
    volumes:
      - commanddeck-state:/home/commanddeck/.commanddeck:ro
      - /var/run/docker.sock:/var/run/docker.sock:ro
    group_add:
      - "${DOCKER_GID:-993}"
    networks:
      - proxy

volumes:
  commanddeck-state:
  commanddeck-projects:

networks:
  proxy:
    external: true
